<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Vovinam Remote Control</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #000; color: white; margin: 0; overflow: hidden; font-family: sans-serif; }
        /* Giao diện Remote cho điện thoại */
        .remote-button {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3rem;
            font-weight: 900;
            border: 2px solid #000;
            touch-action: manipulation;
        }
        .bg-red-score { background-color: #cc0000; }
        .bg-blue-score { background-color: #0000cc; }
        .remote-button:active { opacity: 0.6; transform: scale(0.98); }
        
        /* Ẩn hiện giữa Remote và Bảng điểm */
        #remote-ui { display: none; height: 100vh; flex-direction: column; }
        #desktop-ui { display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        
        /* Hiển thị bảng điểm trên máy tính */
        .large-score { font-size: 12rem; font-weight: 900; }
    </style>
</head>
<body>

    <div id="remote-ui" class="p-2 gap-2">
        <div class="flex flex-1 gap-2">
            <div class="remote-button bg-red-score rounded-xl" onclick="updateScore('red', 1)">ĐỎ +1</div>
            <div class="remote-button bg-red-score rounded-xl" onclick="updateScore('red', 2)">ĐỎ +2</div>
        </div>
        <div class="flex flex-1 gap-2">
            <div class="remote-button bg-blue-score rounded-xl" onclick="updateScore('blue', 1)">XANH +1</div>
            <div class="remote-button bg-blue-score rounded-xl" onclick="updateScore('blue', 2)">XANH +2</div>
        </div>
        <button onclick="location.reload()" class="bg-gray-800 py-2 rounded-lg text-xs opacity-50">Làm mới kết nối</button>
    </div>

    <div id="desktop-ui">
        <div class="w-full max-w-5xl border-8 border-red-600 p-10 bg-black rounded-3xl text-center shadow-[0_0_50px_rgba(255,0,0,0.4)]">
            <h1 class="text-4xl font-bold text-yellow-500 mb-10 uppercase">Bảng Điểm Vovinam Online</h1>
            <div class="flex justify-around items-center">
                <div class="text-red-600">
                    <p class="text-2xl font-bold uppercase">Đội Đỏ</p>
                    <div id="red-score" class="large-score">0</div>
                </div>
                <div class="text-blue-600">
                    <p class="text-2xl font-bold uppercase">Đội Xanh</p>
                    <div id="blue-score" class="large-score">0</div>
                </div>
            </div>
            <div class="mt-10">
                <button onclick="resetAll()" class="bg-gray-700 px-6 py-2 rounded-lg text-sm">RESET ĐIỂM</button>
                <p class="mt-4 text-gray-500 text-xs">Mở link này trên điện thoại để hiện 4 nút bấm</p>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <script>
        // Cấu hình Firebase của bạn
        const firebaseConfig = {
            apiKey: "AIzaSyB2l67XVpiSnzdjWj7-9Nr8UCOXW9XKVnk",
            authDomain: "vovinam-online.firebaseapp.com",
            databaseURL: "https://vovinam-online-default-rtdb.firebaseio.com",
            projectId: "vovinam-online",
            storageBucket: "vovinam-online.firebasestorage.app",
            messagingSenderId: "554190803446",
            appId: "1:554190803446:web:fe9c66dfcbb8b96d9a37d7",
            measurementId: "G-8L6D9VMHR9"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const scoreRef = database.ref('match_score');

        let currentScore = { red: 0, blue: 0 };

        // Tự động nhận diện thiết bị
        if (/Android|iPhone|iPad|iPod/i.test(navigator.userAgent)) {
            document.getElementById('remote-ui').style.display = 'flex';
            document.getElementById('desktop-ui').style.display = 'none';
        }

        // Lắng nghe dữ liệu
        scoreRef.on('value', (snapshot) => {
            const data = snapshot.val();
            if (data) {
                currentScore = data;
                document.getElementById('red-score').innerText = data.red;
                document.getElementById('blue-score').innerText = data.blue;
            }
        });

        // Hàm cộng điểm (+1 hoặc +2)
        function updateScore(team, points) {
            if (team === 'red') currentScore.red += points;
            else currentScore.blue += points;
            scoreRef.set(currentScore);
        }

        function resetAll() {
            if(confirm("Bạn muốn đưa điểm về 0?")) {
                scoreRef.set({ red: 0, blue: 0 });
            }
        }
    </script>
</body>
</html>